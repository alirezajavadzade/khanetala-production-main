import{_ as U,r as s,j as M,k as j,c as V,w as r,a as l,o as w,b as u,t as h,d as A,e,f as E,g as o,l as D,h as J,A as k,i as x}from"./index-Qt0rRlUo.js";const L={class:"d-flex justify-start align-center"},R={class:"d-flex align-start"},$={__name:"OTPView",setup(q){const c=s(""),v=s(!1),_=s(!1),p=s(""),i=s(!1),d=s(120),n=s(!1),b=s("");let m=null;const S=async()=>{try{v.value=!0;const t=await k.VerifyOTP(c.value);return t.userVerificationStatus=="SUCCESS"?x.push("/"):x.push("/Identity"),t}catch(t){p.value=t.response.data.msg||"خطایی رخ داده است!",i.value=!0,setTimeout(()=>{i.value=!1},5e3)}finally{v.value=!1}},T=async()=>{if(console.log(n.value),n.value==!0)try{b.value=JSON.parse(localStorage.getItem("phoneNumber")),await k.Login(b.value),g()}catch(t){p.value=t.response.data.msg||"خطایی رخ داده است!",i.value=!0,setTimeout(()=>{i.value=!1},5e3)}},g=()=>{n.value=!1,d.value=120,m=setInterval(()=>{d.value>0?d.value--:(clearInterval(m),n.value=!0)},1e3)};return M(()=>{g()}),j(()=>{clearInterval(m)}),(t,a)=>{const C=l("v-alert"),I=l("v-otp-input"),N=l("v-sheet"),B=l("router-link"),y=l("v-btn"),O=l("v-form"),P=l("v-card");return w(),V(P,{class:"auth-card","max-width":"360",width:"100%"},{default:r(()=>[i.value?(w(),V(C,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:r(()=>[u(h(p.value),1)]),_:1})):A("",!0),a[4]||(a[4]=e("div",{class:"k-stepper"},[e("div",{class:"step verified"},[e("div",null,[e("span",{class:"circle"},[e("span",{class:"mdi mdi-check"})])]),e("p",{class:"mb-0"},"ورود")]),e("div",{class:"divider verified"}),e("div",{class:"step active"},[e("div",null,[e("span",{class:"circle"})]),e("p",{class:"mb-0"},"تایید شماره")]),e("div",{class:"divider active"}),e("div",{class:"step"},[e("div",null,[e("span",{class:"circle"})]),e("p",{class:"mb-0"},"ثبت اطلاعات")]),e("div",{class:"divider"}),e("div",{class:"step"},[e("div",null,[e("span",{class:"circle"})]),e("p",{class:"mb-0"},"احراز هویت")])],-1)),a[5]||(a[5]=e("img",{src:E,alt:"خانه طلا",class:"my-5"},null,-1)),a[6]||(a[6]=e("h3",null,"تایید شماره همراه",-1)),o(O,{ref:"form",modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=f=>_.value=f),onSubmit:J(S,["prevent"]),class:"auth-form"},{default:r(()=>[o(N,{color:"surface"},{default:r(()=>[o(I,{length:4,modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=f=>c.value=f),type:"number",variant:"outlined",class:"otp-input"},null,8,["modelValue"])]),_:1}),e("div",L,[o(D),o(B,{to:"/login",class:"login-link"},{default:r(()=>a[2]||(a[2]=[u("ویرایش شماره همراه")])),_:1})]),o(y,{type:"submit",class:"my-6",height:"40",text:"تایید کد",variant:"elevated",width:"100%",color:"#B0863B",disabled:c.value.length!==4,loading:v.value},null,8,["disabled","loading"]),e("div",R,[o(y,{variant:"plain",class:"resend-btn",disabled:!n.value,onClick:T},{default:r(()=>[u(h(n.value?"ارسال مجدد کد":`تا دریافت مجدد کد تایید ${d.value} ثانیه`),1)]),_:1},8,["disabled"])]),a[3]||(a[3]=e("p",{class:"site-url"},[u("آدرس رسمی سامانه"),e("span",{class:"k-primary"}," www.khanetala.ir "),u("میباشد")],-1))]),_:1},8,["modelValue"])]),_:1})}}},F=U($,[["__scopeId","data-v-05ae5316"]]);export{F as default};
