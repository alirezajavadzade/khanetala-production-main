import{_ as O,r as u,c as w,w as p,a as i,o as x,b as g,t as Y,d as A,e,f as T,g as r,h as E,A as j,i as q}from"./index-BHSjVa9P.js";const z={class:"d-flex mt-3"},G={__name:"IdentityView",setup(H){const d=u(!1),S=u(""),f=u(!1),b=u(!1),t=u({nationalCode:"",birthDate:""}),m=u(),s=u(),o=u(),k=u([{name:"1",value:1},{name:"2",value:2},{name:"3",value:3},{name:"4",value:4},{name:"5",value:5},{name:"6",value:6},{name:"7",value:7},{name:"8",value:8},{name:"9",value:9},{name:"10",value:10},{name:"11",value:11},{name:"12",value:12},{name:"13",value:13},{name:"14",value:14},{name:"15",value:15},{name:"16",value:16},{name:"17",value:17},{name:"18",value:18},{name:"19",value:19},{name:"20",value:20},{name:"21",value:21},{name:"22",value:22},{name:"23",value:23},{name:"24",value:24},{name:"25",value:25},{name:"26",value:26},{name:"27",value:27},{name:"28",value:28},{name:"29",value:29},{name:"30",value:30},{name:"31",value:31}]),D=u([{name:"فروردین",value:1},{name:"اردیبهشت",value:2},{name:"خرداد",value:3},{name:"تیر",value:4},{name:"مرداد",value:5},{name:"شهریور",value:6},{name:"مهر",value:7},{name:"آبان",value:8},{name:"آذر",value:9},{name:"دی",value:10},{name:"بهمن",value:11},{name:"اسفند",value:12}]),I=u([{name:"1300",value:1300},{name:"1301",value:1301},{name:"1302",value:1302},{name:"1303",value:1303},{name:"1304",value:1304},{name:"1305",value:1305},{name:"1306",value:1306},{name:"1307",value:1307},{name:"1308",value:1308},{name:"1309",value:1309},{name:"1310",value:1310},{name:"1311",value:1311},{name:"1312",value:1312},{name:"1313",value:1313},{name:"1314",value:1314},{name:"1315",value:1315},{name:"1316",value:1316},{name:"1317",value:1317},{name:"1318",value:1318},{name:"1319",value:1319},{name:"1320",value:1320},{name:"1321",value:1321},{name:"1322",value:1322},{name:"1323",value:1323},{name:"1324",value:1324},{name:"1325",value:1325},{name:"1326",value:1326},{name:"1327",value:1327},{name:"1328",value:1328},{name:"1329",value:1329},{name:"1330",value:1330},{name:"1331",value:1331},{name:"1332",value:1332},{name:"1333",value:1333},{name:"1334",value:1334},{name:"1335",value:1335},{name:"1336",value:1336},{name:"1337",value:1337},{name:"1338",value:1338},{name:"1339",value:1339},{name:"1340",value:1340},{name:"1341",value:1341},{name:"1342",value:1342},{name:"1343",value:1343},{name:"1344",value:1344},{name:"1345",value:1345},{name:"1346",value:1346},{name:"1347",value:1347},{name:"1348",value:1348},{name:"1349",value:1349},{name:"1350",value:1350},{name:"1351",value:1351},{name:"1352",value:1352},{name:"1353",value:1353},{name:"1354",value:1354},{name:"1355",value:1355},{name:"1356",value:1356},{name:"1357",value:1357},{name:"1358",value:1358},{name:"1359",value:1359},{name:"1360",value:1360},{name:"1361",value:1361},{name:"1362",value:1362},{name:"1363",value:1363},{name:"1364",value:1364},{name:"1365",value:1365},{name:"1366",value:1366},{name:"1367",value:1367},{name:"1368",value:1368},{name:"1369",value:1369},{name:"1370",value:1370},{name:"1371",value:1371},{name:"1372",value:1372},{name:"1373",value:1373},{name:"1374",value:1374},{name:"1375",value:1375},{name:"1376",value:1376},{name:"1377",value:1377},{name:"1378",value:1378},{name:"1379",value:1379},{name:"1380",value:1380},{name:"1381",value:1381},{name:"1382",value:1382},{name:"1383",value:1383},{name:"1384",value:1384},{name:"1385",value:1385},{name:"1386",value:1386},{name:"1387",value:1387},{name:"1388",value:1388},{name:"1389",value:1389},{name:"1390",value:1390},{name:"1391",value:1391},{name:"1392",value:1392},{name:"1393",value:1393},{name:"1394",value:1394},{name:"1395",value:1395},{name:"1396",value:1396},{name:"1397",value:1397},{name:"1398",value:1398},{name:"1399",value:1399},{name:"1400",value:1400},{name:"1401",value:1401},{name:"1402",value:1402},{name:"1403",value:1403}]),h={nationalCode:[l=>!!l||"کد ملی الزامی است",l=>/^\d{10}$/.test(l)||"کد ملی باید ۱۰ رقم باشد",l=>{if(!/^\d{10}$/.test(l))return!0;const a=+l[9],v=l.split("").slice(0,9).reduce((_,c,y)=>_+ +c*(10-y),0)%11;return v<2&&a===v||v>=2&&a+v===11||"کد ملی نامعتبر است"}],birthDate:[()=>!o.value||!s.value||!m.value?"تاریخ تولد الزامی است":!0]},C=()=>{t.value.nationalCode=t.value.nationalCode.replace(/\D/g,"").slice(0,10);const l=h.nationalCode.every(v=>v(t.value.nationalCode)===!0),a=o.value&&s.value&&m.value;return d.value=l&&a,d.value},N=l=>{m.value=l,V()},B=l=>{s.value=l,V()},M=l=>{o.value=l,V()},V=()=>{if(o.value&&s.value&&m.value){const l=String(s.value).padStart(2,"0"),a=String(m.value).padStart(2,"0");t.value.birthDate=`${o.value}${l}${a}`}C()},U=async()=>{try{t.value.phoneNumber=JSON.parse(localStorage.getItem("phoneNumber")),localStorage.setItem("identifyForm",JSON.stringify(t.value)),b.value=!0;const l=await j.VerifyIdentity(t.value);return localStorage.setItem("userData",JSON.stringify(l.user)),q.push("/IdentityInfo"),l}catch(l){S.value=l.response.data.msg||"خطایی رخ داده است!",f.value=!0,setTimeout(()=>{f.value=!1},5e3)}finally{b.value=!1}};return(l,a)=>{const v=i("v-alert"),_=i("v-text-field"),c=i("v-select"),y=i("v-sheet"),$=i("v-btn"),F=i("v-form"),J=i("v-card");return x(),w(J,{class:"auth-card","max-width":"360",width:"100%"},{default:p(()=>[f.value?(x(),w(v,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:p(()=>[g(Y(S.value),1)]),_:1})):A("",!0),a[6]||(a[6]=e("div",{class:"k-stepper"},[e("div",{class:"step verified"},[e("div",null,[e("span",{class:"circle"},[e("span",{class:"mdi mdi-check"})])]),e("p",{class:"mb-0"},"ورود")]),e("div",{class:"divider verified"}),e("div",{class:"step verified"},[e("div",null,[e("span",{class:"circle"},[e("span",{class:"mdi mdi-check"})])]),e("p",{class:"mb-0"},"تایید شماره")]),e("div",{class:"divider verified"}),e("div",{class:"step active"},[e("div",null,[e("span",{class:"circle"})]),e("p",{class:"mb-0"},"ثبت اطلاعات")]),e("div",{class:"divider active"}),e("div",{class:"step"},[e("div",null,[e("span",{class:"circle"})]),e("p",{class:"mb-0"},"احراز هویت")])],-1)),a[7]||(a[7]=e("img",{src:T,alt:"خانه طلا",class:"my-5"},null,-1)),a[8]||(a[8]=e("h3",null,"احراز هویت",-1)),r(F,{ref:"form",modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=n=>d.value=n),onSubmit:E(U,["prevent"]),class:"auth-form"},{default:p(()=>[r(y,{color:"surface",class:"mt-1"},{default:p(()=>[r(_,{modelValue:t.value.nationalCode,"onUpdate:modelValue":a[0]||(a[0]=n=>t.value.nationalCode=n),type:"text",label:"کد ملی",variant:"outlined",class:"k-textfield",rules:h.nationalCode,onInput:C},null,8,["modelValue","rules"]),e("div",z,[r(c,{modelValue:m.value,"onUpdate:modelValue":[a[1]||(a[1]=n=>m.value=n),N],label:"روز",items:k.value,variant:"outlined","item-title":"name","item-value":"value",class:"first-select",rules:[n=>!!n||"روز الزامی است"]},null,8,["modelValue","items","rules"]),r(c,{modelValue:s.value,"onUpdate:modelValue":[a[2]||(a[2]=n=>s.value=n),B],label:"ماه",items:D.value,variant:"outlined",class:"second-select","item-title":"name","item-value":"value",rules:[n=>!!n||"ماه الزامی است"]},null,8,["modelValue","items","rules"]),r(c,{modelValue:o.value,"onUpdate:modelValue":[a[3]||(a[3]=n=>o.value=n),M],label:"سال",items:I.value,variant:"outlined",class:"third-select","item-title":"name","item-value":"value",rules:[n=>!!n||"سال الزامی است"]},null,8,["modelValue","items","rules"])])]),_:1}),r($,{type:"submit",class:"my-6",height:"40",text:"بررسی احراز هویت",variant:"elevated",width:"100%",color:"#B0863B",disabled:!d.value,loading:b.value},null,8,["disabled","loading"]),a[5]||(a[5]=e("p",{class:"site-url"},[g("آدرس رسمی سامانه"),e("span",{class:"k-primary"}," www.khanetala.ir "),g("میباشد")],-1))]),_:1},8,["modelValue"])]),_:1})}}},L=O(G,[["__scopeId","data-v-c96bf78d"]]);export{L as default};
